-- Fix search_path for security functions
ALTER FUNCTION public.update_memory_vault_updated_at() SET search_path = '';
ALTER FUNCTION public.check_daily_message_limit(uuid, uuid) SET search_path = '';
ALTER FUNCTION public.check_whisper_window_constraints(uuid, uuid, text) SET search_path = '';
ALTER FUNCTION public.generate_ai_match_wrapper() SET search_path = '';
ALTER FUNCTION public.uid() SET search_path = '';
ALTER FUNCTION public.generate_match_preview(uuid, uuid) SET search_path = '';
ALTER FUNCTION public.schedule_risk_assessment() SET search_path = '';
ALTER FUNCTION public.generate_ai_match() SET search_path = '';
ALTER FUNCTION public.handle_new_user() SET search_path = '';
ALTER FUNCTION public.compute_match_embedding(uuid, uuid) SET search_path = '';
ALTER FUNCTION public.secure_generate_ai_match_deprecated() SET search_path = '';
ALTER FUNCTION public.check_security_event_access(uuid) SET search_path = '';
ALTER FUNCTION public.archive_expired_matches() SET search_path = '';
ALTER FUNCTION public.schedule_match_archiving() SET search_path = '';
ALTER FUNCTION public.check_user_security_level() SET search_path = '';
ALTER FUNCTION public.get_premium_matches(uuid, double precision, text, integer, integer) SET search_path = '';
ALTER FUNCTION public.compute_interaction_risk(uuid) SET search_path = '';
ALTER FUNCTION public.generate_daily_compatibility_digest(uuid) SET search_path = '';
ALTER FUNCTION public.update_match_velocity(uuid) SET search_path = '';
ALTER FUNCTION public.generate_match_summary(uuid, uuid) SET search_path = '';
ALTER FUNCTION public.generate_top_picks(uuid, integer) SET search_path = '';
ALTER FUNCTION public.example_function(text, integer) SET search_path = '';
ALTER FUNCTION public.auto_generate_match_details() SET search_path = '';
ALTER FUNCTION public.secure_generate_ai_match_new() SET search_path = '';
ALTER FUNCTION public.generate_ai_match_v2() SET search_path = '';
ALTER FUNCTION public.generate_ai_match_wrapper(bigint) SET search_path = '';
ALTER FUNCTION public.generate_ai_match(uuid) SET search_path = '';
ALTER FUNCTION public.calculate_match_intelligence(uuid) SET search_path = '';
ALTER FUNCTION public.perform_sensitive_action(jsonb) SET search_path = '';
ALTER FUNCTION public.update_user_security_level() SET search_path = '';
ALTER FUNCTION public.log_security_event(text, jsonb, inet, text) SET search_path = '';
ALTER FUNCTION public.check_rate_limit(text, inet, integer, integer) SET search_path = '';
ALTER FUNCTION public.track_failed_login(text, inet, text) SET search_path = '';
ALTER FUNCTION public.create_signup_event_for_user(uuid) SET search_path = '';